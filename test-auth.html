<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auth Test</title>
</head>
<body>
    <h1>Authentication Test</h1>
    <button onclick="testAuth()">Test Authentication</button>
    <button onclick="clearAuth()">Clear Authentication</button>
    <button onclick="checkAuth()">Check Authentication</button>
    <div id="output"></div>

    <script>
        function testAuth() {
            // Simulate OAuth callback data
            const testUser = {
                id: 'test-123',
                email: 'test@example.com',
                username: 'testuser',
                is_active: true,
                is_superuser: false,
                role_name: 'viewer'
            };
            
            const testTokens = {
                access_token: 'test-access-token',
                refresh_token: 'test-refresh-token',
                expires_in: 3600
            };
            
            const authData = {
                user: testUser,
                tokens: testTokens
            };
            
            // Store using the correct keys
            localStorage.setItem('auth_access_token', authData.tokens.access_token);
            localStorage.setItem('auth_refresh_token', authData.tokens.refresh_token);
            localStorage.setItem('auth_user', JSON.stringify(authData.user));
            
            document.getElementById('output').innerHTML = '<p>‚úÖ Authentication data stored successfully</p>';
        }
        
        function clearAuth() {
            localStorage.removeItem('auth_access_token');
            localStorage.removeItem('auth_refresh_token');
            localStorage.removeItem('auth_user');
            document.getElementById('output').innerHTML = '<p>üóëÔ∏è Authentication data cleared</p>';
        }
        
        function checkAuth() {
            const accessToken = localStorage.getItem('auth_access_token');
            const refreshToken = localStorage.getItem('auth_refresh_token');
            const userStr = localStorage.getItem('auth_user');
            
            let output = '<h3>Authentication Status:</h3>';
            output += `<p>Access Token: ${accessToken ? '‚úÖ Present' : '‚ùå Missing'}</p>`;
            output += `<p>Refresh Token: ${refreshToken ? '‚úÖ Present' : '‚ùå Missing'}</p>`;
            output += `<p>User Data: ${userStr ? '‚úÖ Present' : '‚ùå Missing'}</p>`;
            
            if (userStr) {
                try {
                    const user = JSON.parse(userStr);
                    output += `<p>Username: ${user.username}</p>`;
                    output += `<p>Email: ${user.email}</p>`;
                    output += `<p>Role: ${user.role_name}</p>`;
                } catch (e) {
                    output += `<p>‚ùå Error parsing user data: ${e.message}</p>`;
                }
            }
            
            document.getElementById('output').innerHTML = output;
        }
    </script>
</body>
</html> 